#!/usr/bin/env python2.6

import os
import sys

from xmltodict import parse as xml_to_dict
from get_grid_downtimes import get_egi, get_osg

def main():

    if len(sys.argv) < 2:
        print "Usage: %s entry_name [entry_name, ...]"
        return 1

    entry_names = sys.argv[1:]

    factory_config_file = os.path.join( os.getenv('GLIDEIN_FACTORY_DIR'), "glideinWMS.xml")

    factory_config = xml_to_dict( open( factory_config_file))
    factory_entries = factory_config['glidein']['entries']['entry']

    current_downtimes = {'EGI': get_egi(),
                         'OSG': get_osg()}

    print current_downtimes.popitem()
    print factory_entries.popitems()

if __name__ == "__main__":
    sys.exit (main())

