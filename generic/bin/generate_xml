#!/usr/bin/python

from xml.dom.minidom import parse
import sys
STARTUP_DIR=sys.path[0]
import os
sys.path.append(os.path.join(STARTUP_DIR, '../lib'))
import conf_util

doc = parse('../share/tmpl.xml')

entry = doc.documentElement
#entry.writexml(sys.stdout)

#for c in children:
#  print c.nodeType

entry.setAttribute(u'name', u'CMS_T2_US_UCSD_gw7')
entry.setAttribute(u'comment', u'Added 2013-03-13 --Alex')
entry.setAttribute(u'gatekeeper', u'osg-gw-7.t2.ucsd.edu:2119/jobmanager-condor')
entry.setAttribute(u'gridtype', u'gt5')
entry.setAttribute(u'rsl', u'(queue=default)(jobtype=single)')
entry.setAttribute(u'work_dir', u'Condor')

attrs_el = entry.getElementsByTagName('attrs')[0]

conf_util.insert_empty_el(doc, attrs_el, u'attr', {u'name':u"GLIDEIN_Max_Walltime",
  u'const':u"True",
  u'glidein_publish':u"False",
  u'job_publish':u"False",
  u'parameter':u"True",
  u'publish':u"True",
  u'type':u"int",
  u'value':u"171000"})

conf_util.insert_empty_el(doc, attrs_el, u'attr', {u'name':u"GLIDEIN_ResourceName",
  u'const':u"True",
  u'glidein_publish':u"True",
  u'job_publish':u"True",
  u'parameter':u"True",
  u'publish':u"True",
  u'type':u"string",
  u'value':u"UCSDT2"})

conf_util.insert_empty_el(doc, attrs_el, u'attr', {u'name':u"GLIDEIN_Supported_VOs",
  u'const':u"True",
  u'glidein_publish':u"False",
  u'job_publish':u"False",
  u'parameter':u"True",
  u'publish':u"True",
  u'type':u"string",
  u'value':u"CMS,HCC,NEBioGrid,SBGrid,GLUEX,UCSDRok,NWICG,HCCLONG,CMST2UCSD,EngageVO,NEES,OSGVO,CIGI,glowVO,OSGEDU,Fermilab"})

infosys_el = entry.getElementsByTagName('infosys_refs')[0]

conf_util.insert_empty_el(doc, infosys_el, u'infosys_ref',
  {u'ref':u"GlueCEUniqueID=osg-gw-7.t2.ucsd.edu:2119/jobmanager-condor-default,Mds-Vo-name=UCSDT2,Mds-Vo-name=local,o=grid",
    u'server':u'is.grid.iu.edu',
    u'type':u"BDII"})

conf_util.write_entry(sys.stdout, entry)
print
doc.unlink()
